<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <template t-name="prisma_reports_inherit.report_purchase_template_custom_lang">
        <t t-call="web.external_layout">
            <!--            <t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/>-->
            <!--            <t t-set="address">-->
            <!--                <div t-field="o.partner_id"-->
            <!--                     t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"/>-->
            <!--                <p t-if="o.partner_id.vat"><t t-esc="o.company_id.account_fiscal_country_id.vat_label or 'Tax ID'"/>:-->
            <!--                    <span t-field="o.partner_id.vat"/>-->
            <!--                </p>-->
            <!--            </t>-->
            <!--            <t t-if="o.dest_address_id">-->
            <!--                <t t-set="information_block">-->
            <!--                    <strong>Shipping address:</strong>-->
            <!--                    <div t-if="o.dest_address_id">-->
            <!--                        <div t-field="o.dest_address_id"-->
            <!--                             t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"-->
            <!--                             name="purchase_shipping_address"/>-->
            <!--                    </div>-->

            <!--                </t>-->
            <!--            </t>-->
            <div class="page">
                <t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/>
                <t t-set="address">
                    <div t-field="o.partner_id"
                         t-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;], &quot;no_marker&quot;: True, &quot;phone_icons&quot;: True}"/>
<!--                    <p t-if="o.partner_id.vat"><t t-esc="o.company_id.account_fiscal_country_id.vat_label or 'Tax ID'"/>-->
<!--                        :-->
<!--                        <span t-field="o.partner_id.vat"/>-->
<!--                    </p>-->
                </t>
                <div class="oe_structure"/>

                <h4 t-if="o.state in ['draft', 'sent', 'to approve']">Request for Quotation #
                    <span t-field="o.name"/>
                </h4>
                <h4 t-if="o.state in ['purchase', 'done']">Purchase Order #
                    <span t-field="o.name"/>
                </h4>
                <h4 t-if="o.state == 'cancel'">Cancelled Purchase Order #
                    <span t-field="o.name"/>
                </h4>

                <div id="delivery" class="row mt32 mb32">
                    <div t-if="o.picking_type_id.warehouse_id.name" class="col-12 bm-2">
                        <strong>Delivery To:</strong>
                        <p t-field="o.picking_type_id.warehouse_id.partner_id.street" class="m-0"/>
                        <p t-field="o.picking_type_id.warehouse_id.partner_id.street2" class="m-0"/>
                        <p t-field="o.picking_type_id.warehouse_id.partner_id.city" class="m-0"/>
                        <p t-field="o.picking_type_id.warehouse_id.partner_id.country_id.name" class="m-0"/>
                    </div>
                </div>
                <div id="informations" class="row mt32 mb32">
                    <div t-if="o.user_id" class="col-3 bm-2">
                        <strong>Purchase Representative:</strong>
                        <p t-field="o.user_id" class="m-0"/>
                    </div>
                    <div t-if="o.partner_ref" class="col-3 bm-2">
                        <strong>Your Order Reference:</strong>
                        <p t-field="o.partner_ref" class="m-0"/>
                    </div>
                    <div t-if="o.date_order" class="col-3 bm-2">
                        <strong>Order Date:</strong>
                        <p t-field="o.date_order" class="m-0"/>
                    </div>
                </div>

                <table class="table table-sm o_main_table">
                    <thead>
                        <tr>
                            <th name="th_description">
                                <strong>SR#</strong>
                            </th>
                            <th name="th_serial_no">
                                <strong>Description</strong>
                            </th>
                            <th name="th_quantity">
                                <strong>Qty</strong>
                            </th>
                            <th name="th_price_unit">
                                <strong>Unit Price</strong>
                            </th>
                            <th name="th_amount">
                                <strong>Amount Before Tax</strong>
                            </th>
                            <th name="th_taxes">
                                <strong>Taxes</strong>
                            </th>
                            <th name="th_amount">
                                <strong>Amount After Tax</strong>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="serial_no" t-value="1"/>
                        <t t-set="total_qty" t-value="0"/>
                        <t t-set="total_price_subtotal" t-value="0"/>
                        <t t-set="total_price" t-value="0"/>
                        <t t-set="current_subtotal" t-value="0"/>
                        <t t-foreach="o.order_line" t-as="line">
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal"
                               groups="account.group_show_line_subtotals_tax_excluded"/>
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_total"
                               groups="account.group_show_line_subtotals_tax_included"/>

                            <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                <t t-if="not line.display_type">
                                    <td name="td_serial_no">
                                        <span t-esc="serial_no"/>
                                        <t t-set="serial_no" t-value="serial_no + 1"/>
                                    </td>
                                    <td id="product">
                                        <span t-field="line.name"/>
                                    </td>
                                    <td>
                                        <span t-field="line.product_qty"/>
                                        <span t-field="line.product_uom.name" groups="uom.group_uom"/>
                                        <t t-set="total_qty" t-value="total_qty + line.product_qty"/>
                                    </td>
                                    <td>
                                        <span t-field="line.price_unit"/>
                                    </td>
                                    <td>
                                        <span t-field="line.price_subtotal"
                                              t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                        <t t-set="total_price_subtotal"
                                           t-value="total_price_subtotal + line.price_subtotal"/>
                                    </td>
                                    <td>
                                        <span t-esc="', '.join(map(lambda x: x.name, line.taxes_id))"/>
                                    </td>
                                    <td>
                                        <span t-field="line.price_total"
                                              t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
                                        <t t-set="total_price" t-value="total_price + line.price_total"/>
                                    </td>
                                </t>
                                <!--                                <t t-if="line.display_type == 'line_section'">-->
                                <!--                                    <td colspan="99" id="section">-->
                                <!--                                        <span t-field="line.name"/>-->
                                <!--                                    </td>-->
                                <!--                                    <t t-set="current_section" t-value="line"/>-->
                                <!--                                    <t t-set="current_subtotal" t-value="0"/>-->
                                <!--                                </t>-->
                                <!--                                <t t-if="line.display_type == 'line_note'">-->
                                <!--                                    <td colspan="99" id="note">-->
                                <!--                                        <span t-field="line.name"/>-->
                                <!--                                    </td>-->
                                <!--                                </t>-->
                            </tr>
                            <!--                            <t t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">-->
                            <!--                                <tr class="is-subtotal text-right">-->
                            <!--                                    <td colspan="99" id="subtotal">-->
                            <!--                                        <strong class="mr16">Subtotal</strong>-->
                            <!--                                        <span t-esc="current_subtotal"-->
                            <!--                                              t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>-->
                            <!--                                    </td>-->
                            <!--                                </tr>-->
                            <!--                            </t>-->
                        </t>
                        <tr>
                            <td>
                                <strong>Total</strong>
                            </td>
                            <td></td>
                            <td>
                                <strong>
                                    <t t-esc="total_qty"/>
                                </strong>
                            </td>
                            <td></td>
                            <td>
                                <strong>
                                    <t t-esc="'{:,}'.format(total_price_subtotal)"/>&#160;&#160;Rs
                                </strong>
                            </td>
                            <td></td>
                            <td>
                                <strong>
                                    <t t-esc="'{:,}'.format(total_price)"/>&#160;&#160;Rs
                                </strong>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <!--                <div id="total" class="row justify-content-end">-->
                <!--                    <div class="col-4">-->
                <!--                        <table class="table table-sm">-->
                <!--                            <t t-set="tax_totals" t-value="json.loads(o.tax_totals_json)"/>-->
                <!--                            <t t-call="account.document_tax_totals"/>-->
                <!--                        </table>-->
                <!--                    </div>-->
                <!--                </div>-->

                <p t-field="o.notes"/>

                <div class="oe_structure"/>
                <br/>
                <br/>
                <br/>
                <div class="row">
                    <div class="col-12">
                        <strong>RS.&#160;&#160;&#160;&#160;&#160;<t t-esc="o.number_to_words(total_price)"/>
                        </strong>
                    </div>
                </div>

                <br/>
                <br/>
                <br/>
                <div class="row">
                    <div class="col-12">
                        <strong>This is a system generated
                            document and does not require
                            sign and stamp
                        </strong>
                    </div>
                </div>

            </div>
        </t>
    </template>


    <template t-name="prisma_reports_inherit.report_purchase_template_custom">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="prisma_reports_inherit.report_purchase_template_custom_lang" t-lang="o.partner_id.lang"/>
            </t>
        </t>
    </template>


</odoo>